---
title: "D2SC: Weekly Assignments"
date: "2024-9-10"
author: "Vidushi Kataria"
output: html_notebook
---
# Initial Heading
```{r}
library(tidyverse)
```
# Week 1
Due to my previous programming experience and coursework using R, I knew to use library() to load the tidyverse package.

I did refer to this website, as it gave me a concise description between each function within tidyverse: https://www.tidyverse.org/packages/ 

I checked that it was working by using the command and return buttons on my keyboard to run the code. The console is able to tell me if the code successfully ran or had errors. 

```{r}
help("tidyverse")
```
tidyverse-package {tidyverse}	R Documentation
tidyverse: Easily Install and Load the 'Tidyverse'
Description
logo
The 'tidyverse' is a set of packages that work in harmony because they share common data representations and 'API' design. This package is designed to make it easy to install and load multiple 'tidyverse' packages in a single step. Learn more about the 'tidyverse' at https://www.tidyverse.org.

Author(s)
Maintainer: Hadley Wickham hadley@rstudio.com

Other contributors:

RStudio [copyright holder, funder]

See Also
Useful links:

https://tidyverse.tidyverse.org

https://github.com/tidyverse/tidyverse

Report bugs at https://github.com/tidyverse/tidyverse/issues
--------------------------------------------------------------------------------
# Assignment 2

```{r}
library(dplyr)
getwd()
match_trials <- read_csv("tidy_data/MFIndD_analogy.csv")
```

The qualtrics_id column contains the unique identifier for each participant. 

```{r}
glimpse(match_trials)
```
## 2a: There are 792 rows and 6 columns. I got this information from the output of using the function glimpse()

```{r}
people <- match_trials %>%
  distinct(qualtrics_id) %>%
  nrow()
people
```

## 2b: There are 99 unique people in the dataset, as found by counting distinct qualtrics_id values.

```{r}
trial_counts <- match_trials %>%
  count(qualtrics_id) %>%
  pull(n) %>%
  n_distinct()

trial_counts == 1
```

## 2c: Every unique qualtrics_id has data from the same number of trials, as I counted the number of trials per person, extracted the column, and checked if all values are the same.
--------------------------------------------------------------------------

# Assignment 3

```{r}
summary_match_trials <- match_trials %>%
  group_by(qualtrics_id) %>%
  summarize(relational_match_count = sum(response_type == "Rel"))

head(summary_match_trials)
```


```{r}
summary_match_trials %>%
  ggplot(aes(x = relational_match_count)) +
  geom_histogram(bindwidth = 1,
                 color = "black", fill = "lightblue") +
  labs(x = "# of Relational Matches Selected",
       y = "# of Participants",
       title = "Relational Matches Selected by Participants")
```
A lot of participants selected 8 relational matches, showing a strong preference for relational matches in many cases. However, there is also a small, yet noticeable peak around 2 relational matches. From what I observe, either participants strongly favored relational matches or preferred object matches, with fewer participants showing moderate selections.


```{r}
reshaped_match_trials <- match_trials %>%
  select(qualtrics_id,
         trial_number,
         response_type) %>%
pivot_wider(names_from = trial_number,
              values_from = response_type,
              names_prefix = "trial") %>%
  drop_na

head(reshaped_match_trials)
```


```{r, eval=FALSE} 
# Error code chunk
reshaped_match_trials <- match_trials %>%
  filter(qualtrics_id,
         trial_number,
         response_type) %>%
  pivot_wider(names_from = trial_number,
              values_from = response_type)
```
R told me I used the wrong function as it does not run character vectors. I searched up all the functions in tidyr and dplyr in the help panel to the right to see what other functions I could use for character vectors.

-----------------------------------------------------------------------
# Assignment 4
```{r}
rei_data <- read_csv("tidy_data/MFIndD_REI.csv")

head(rei_data)
```
The "response" column is a CHR vector (text) and the "scored_response" column is an INT (numeric) vector. 
They are different even though they both appear to contain numbers is because there is a difference in how the data is represented. The "response" column most likely contains qualitative responses like "Strongly Agree" or "Agree" etc. So this text is not directly numerical.
The "scored_response" column contains numeric values because they might have already been converted and stored as a number.

```{r}
rei_data <- rei_data %>%
  mutate(numeric_response = case_when(
    response == "Strongly Disagree" ~ 1,
    response == "Strongly Agree" ~ 5,
    !is.na(as.numeric(response)) ~ as.numeric(response),
    TRUE ~ NA_real_
  ))

head(rei_data)
```
```{r}
rei_data %>%
  distinct(response)
```


```{r}
rei_data <- rei_data %>%
  mutate(new_scored_response = if_else(!is.na(rev_scoring),
                                      6 - numeric_response,
                                      numeric_response))
head(rei_data)
```

```{r}
comparison <- rei_data %>%
  filter(new_scored_response != scored_response) 

print(comparison)
```
-----------------------------------------------------------

# Assignment 5

```{r}
rei_data <- rei_data %>%
  mutate(new_scored_response = ifelse(rev_scoring == "neg", 6 - new_scored_response, new_scored_response))

rei_summary <- rei_data %>%
  group_by(qualtrics_id, sub_type) %>%
  summarize(score = sum(new_scored_response, na.rm = TRUE), .groups = 'drop')

print(rei_summary)
```


```{r}
rei_na_scores <- rei_summary %>%
  filter(is.na(score))

print(rei_na_scores)
```
This code filters out any rows with missing values in the score column, which helps with identifying which participants have missing data.


```{r}
combined_summary <- rei_summary %>%
  left_join(summary_match_trials, by = "qualtrics_id")

print(combined_summary)
```

```{r}

ggplot(combined_summary, aes(x = score, y = relational_match_count, color = sub_type)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) + 
  labs(x = "REI Score", 
       y = "Analogy Score",
       title = "REI vs. Analogy Scores by Sub-Type") +
  theme_minimal() +
  theme(axis.title.x = element_text(color = "blue", size = 12),
        axis.title.y = element_text(color = "blue", size = 12))
```
This plot shows a pretty weak relationship between REI scores and Analogy scores across the four sub-types (EA, EE, RA, RE).
There is a slight positive trend for EA, but the other sub-types show slightly negative trends. There is a lot of noise in the plot which suggests that REI scores do not strongly predict the Analogy score performance.
